title: "Zend Translate и сканирование директорий"
tags:
- i18n
- zend-framework
- zend_translate

<body>
<p>Здарова, юзеры ZF!

Большинство из вас уже используют <strong>Zend_Translate</strong>. До сих пор возможность для сканирования каталогов для перевода файлов была доступна только при создании экземпляра Zend_Translate.

Теперь я добавил эту возможность  также и для метода <em>addTranslation()</em>, который означает, что вы теперь можете добавлять новые каталоги после создания экземпляра объекта. Эта функция удобна, когда вы используете модульную структуру приложения и файлы с переводами существуют для каждого модуля в отдельности.

Для тех, кто ничего не знает про данную функциональность - у меня тут есть краткое описание:

Вместо того, чтобы добавлять переводы вручную, будет гораздо удобнее использовать автоматическое добавление переводов, используя только один вызов метода.
~

Не рекомендуемый метод добавления переводов:
</p>
<div class="gist-wrapper"><script src="https://gist.github.com/1768692.js?file=gistfile1.php"></script></div>
Как вы видите, мы добавили лишь переводы для трех языков... Если вы работаете с разделенными переводами, когда для каждого языка используется несколько файлов перевода, то вам потребуется добавить гораздо больше файлов.

Поэтому, было бы лучше, если бы вы сделали это при помощи встроенной функциональности Zend_Translate. Смотрите следующий код:
<div class="gist-wrapper"><script src="https://gist.github.com/1768694.js?file=gistfile1.php"></script></div>
Что происходит при использовании этого кода:

Zend_Translate получает список директорий по указанному пути. При помощи опции <em>scan</em> мы сообщяем ему, что  имена вложенных директорий по указанному пути являются именами языка/локали. Теперь Zend_Translate пробежится по всем вложенным директориям и автоматически добавит все найденные переводы.

Таким образом, файл <em>/my/proj/lang/de/proj.mo</em> будет добавлен в локаль <em>de</em>, так как имя каталога, содержащего файл перевода совпадает с именем немецкой локали. Не имеет значения, какую глубину вложенности имеют файлы каталога <em>/my/proj/lang/de/ </em>- все файлы переводов будут найдены во всех подкаталогах директории. Это работает не только с c адаптером <em>gettext</em>, но и с любым другим, таким как <em>TMX</em>, <em>Array</em>, <em>CSV </em>и т.д. Единственное, что должно совпасть - это имя директории с переводами с именем локали.

Но есть и другой способ, чтобы получить имя локали. Локаль может быть прописана в имени файла, одним из следующих способов:
<div class="gist-wrapper"><script src="https://gist.github.com/1768696.js?file=gistfile1."></script></div>
Все эти три способа именования файлов будут признаны для локали <em>de</em>.

Для использования этого способа именования вам только нужно установить значение <em>Zend_Locale::LOCALE_FILENAME</em> у опции <em>scan</em>.
<p style="text-align: right;"><em>Этот пост - вольный <a rel="noindex,nofollow" href="http://www.thomasweidner.com/flatpress/2008/03/02/zend-translate-and-directory-scanning/comments/">перевод поста</a> Томаса Вейднера,
Главного чувака в команде ZF по интернационализации.</em></p>
</body>
