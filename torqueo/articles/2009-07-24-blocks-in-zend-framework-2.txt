title: "Блоки в Zend Framework, версия 2"
tags:
- zend-framework
- zf-action-helper

<body>
<p>В своей статье <a href="http://torqueo.net/blocks-in-zend-framework/">Блоки в Zend Framework</a> я рассказал, как можно встраивать блоки в макет приложения на <strong>Zend Framework</strong>. Но, как оказалось, предложенный мною способ не является удобным - мы не можем управлять поведением блоков, то есть не можем включать их только для некоторых контроллеров. Это был огромный недостаток.

Но! Я хорошенько обмозговал все это дело и решил исправить ситуацию. Итак, представляю вам второй способ работы с блоками в ZF.
~

Конфиг блоков я оставил в том виде, в каком он был:
</p>
<div class="gist-wrapper"><script src="https://gist.github.com/1768686.js?file=gistfile1.ini"></script></div>
Только убрал у блоков параметр <em>supportXhr </em>- теперь все блоки по-умолчанию не будут загружаться, если произошел <em>AJAX </em>запрос.

Дальше, пришлось написать для пущего удобства помощник действия (<em>action helper</em>) и отказаться от использования плагина фронт-контроллера (<em>controller plugin</em>). Это было сделано для того, чтобы можно было управлять поведением блоков из действий контроллера.

Помощник действия получился таким:
<div class="gist-wrapper"><script src="https://gist.github.com/1768688.js?file=gistfile1.php"></script></div>
Теперь мы можем загрузить блок прямо из действия контроллера таким образом:
<div class="gist-wrapper"><script src="https://gist.github.com/1768689.js?file=gistfile1.php"></script></div>
Для сквозных блоков, то есть тех, которые есть на каждой странице сайта, рекомендую делать базовый контроллер для всех остальных контроллеров и в его методе <em>preDispatch()</em> загружать нужные блоки.

Кстати, нельзя сначала загрузить блок, а потом выгрузить его. Обратного пути нет. Блок можно только загрузить  - обратное действие нелогично и неэффективно.

Кто-то может спросить - а зачем нужен конфиг блоков? Смысл конфига, в основном, заключается в систематизации - мы видим в одном месте, какие блоки у нас имеются на сайте. К тому же, код загрузки блока при помощи помощника действия уменьшился, так как мы указываем только имя блока. Еще один плюс - мы можем поменять значения модуля, контроллера и действия в одном месте. Считаю это удобным.

До скорого.</body>
