title: "Свой шаблон для генератора контроллеров в Rails 3"
tags:
- rails-3
- rails-generators
- rails-templates

<body>
<p>Как известно, в Rails 3 можно использовать новый стиль кодирования, основанный на применении респондеров (Responders). То есть, форматы ответов задаются при помощи ключевого слова <b>respond_to</b>, а в экшенах используется <b>respond_with</b>.

Однако, нисмотря на то, что в таком стиле вы можете писать свои контроллеры уже сейчас, rails-генераторы (scaffold, controller и resource) все еще генерируют контроллеры на основе старого шаблона, в котором используется старый стиль кодирования. Раньше мне приходилось вручную переводить вновь сгенерированные контроллеры в новый стиль, пока я не переопределил стандартный шаблон контроллера.

В Rails 3 теперь можно удобно переопределить стандартный шаблон генератора контроллеров. Самый простой способ, это просто положить готовый шаблон (он приведен в конце статьи) в файл:

</p>
<pre>yourapp/lib/templates/rails/scaffold_controller/controller.rb</pre>

В этом случае, шаблон будет автоматически "подхватываться" при генерировании контроллера.

Второй способ может понадобиться, если нужно переопределить шаблон из гема или плагина. Для этого нужно сначала прописать в файле <b>lib/yourgemname.rb</b> вашего гема следующее:

<div class="gist-wrapper"><script src="https://gist.github.com/1768887.js?file=gistfile1.rb"></script></div>

Этим мы указываем, что генератор контроллеров должен использовать наш генератор. Файл генератора должен располагаться по пути <b>lib/generators/rails/yourgemname_controller_generator.rb</b> Теперь давайте посмотрим, как выглядит наш собственный генератор:

<div class="gist-wrapper"><script src="https://gist.github.com/1768888.js?file=gistfile1.rb"></script></div>

Здесь все просто - мы наследуемся от базового класса генератора и указываем новый путь к шаблонам. Шаблон должен располагаться по пути <b>lib/generators/rails/templates/controller.rb</b>. Теперь посмотрим, как выглядит сам шаблон в стиле Rails 3:

<div class="gist-wrapper"><script src="https://gist.github.com/1768889.js?file=gistfile1.rb"></script></div>

Вот и все. Теперь при генерировании нового контроллера будет использоваться наш шаблон.

<i>P.S: Хочу предупредить, что в Rails 3.1 (которая edge на момент написания статьи) это не будет работать в некоторых случаях, так как в этой версии есть небольшие изменения в шаблоне, а в приведенном мною шаблоне они не учитываются.</i>
</body>
