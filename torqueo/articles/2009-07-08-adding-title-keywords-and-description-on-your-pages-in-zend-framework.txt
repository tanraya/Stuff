title: "Установка title, keywords и description на страницы сайта в Zend Framework"
tags:
- zend-framework
- zf-front-controller-plugin
- zf-layout
- zf-view
- zf-view-helpers

<body>
<p>Итак, в один прекрасный момент работы с Zend Framework вам понадобится устанавливать title, description и keywords или какую-либо другую информацию к своим страницам, получая эту информацию из БД.

Можно долго думать, как сделать это наиболее правильно, как долго думал я. Но в итоге, посовещавшись с некоторыми людьми, я пришел к выводу, что лучшего решения, как сделать плагин для фронт-контроллера - не найти.

Поэтому, я написал эту функциональность в виде готового плагина.
~
</p>
<div class="gist-wrapper"><script src="https://gist.github.com/1768660.js?file=gistfile1.php"></script></div>
Как видно по названию плагина - структура библиотек моего приложения следует соглашению об именовании ZF, и повторяет структуру его библиотек для удобства. Все плагины загружаются автоматически при помощи  <em>Zend_Loader_Autoloader</em>. Точно так же загружается и плагин из <a href="/load-view-template-in-zend-framework-if-exists/">предыдущего поста</a>.

К фронт-контроллеру плагин подключается следующим образом:
<div class="gist-wrapper"><script src="https://gist.github.com/1768663.js?file=gistfile1.php"></script></div>
Теперь разберемся, что же происходит внутри плагина и как он работает. В методе <em>preDispatch()</em> нашего плагина мы получаем информацию о странице из БД, используя модель <em>Sitemap </em>и основываясь на текущем URI. Затем сохраняем полученную информацию в свойстве объекта плагина и в <em>Zend_Registry</em>.

Мы получаем информацию из БД именно в методе <em>preDispatch()</em> для того, чтобы она была доступна так же и в действии (action), чтобы нам не пришлось делать еще один SQL запрос, если мы захотим работать с информацией о странице внутри действия.

Затем, в методе <em>postDispatch()</em> мы получаем экземпляр объекта <em>Zend_Layout</em> и зарегистрированный в нём объект <em>Zend_View</em>. Он то нам и нужен. Дальше, при помощи помощников вида <em>headTitle </em>и <em>headMeta </em>мы устанавливаем в макет (layout) нужную информацию.

В макете, в секции <em>head</em>, выводим заголовок и мета-теги следующим образом:
<div class="gist-wrapper"><script src="https://gist.github.com/1768667.js?file=gistfile1.html"></script></div>
Вот и все. Юзайте Zend Framework! :)</body>
