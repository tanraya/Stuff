title: "Блоки в Zend Framework"
tags:
- plugins
- zend-framework
- zf-front-controller-plugin

<body>
<p>В <a href="/admin-menu-or-blocks-in-zend-framework/">предыдущей заметке</a> я рассказывал, как сделать меню администратора на сайте в виде блока, встраиваемого в макет. В конце заметки я обещал написать, как сделать так, чтобы было удобно использовать блоки в <strong>Zend Framework</strong>. В этом посте я расскажу, как это сделать.

Если следовать принципу предыдущей заметки, то для каждого блока нам понадобилось бы создавать отдельный плагин фронт-контроллера, и подключать его в Bootstrap-файле. Но это накладные расходы, чего нам не надо.
~

<strong>Внимание! Читаем новую версию: <a href="/blocks-in-zend-framework-2/">Блоки в Zend Framework, версия 2</a></strong>

Я пришел к выводу, что оптимальнее всего было бы сделать отдельный конфигурационный файл, где были бы описаны все блоки, существующие у нас на сайте. Скажу сразу, что нас интересуют только такие блоки, которые имеют какое-либо поведение (юзер-кастом блоки, блоки зависящие от некоторого состояния приложения и т.п).

В общем, я сделал вот такой ini-файл <em>blocks.ini</em>, где разместил определение интересующих меня блоков:
</p>
<div class="gist-wrapper"><script src="https://gist.github.com/1768677.js?file=gistfile1.ini"></script></div>
Дальше я создал плагин фронт-контроллера, где подключил конфиг blocks.ini и совершил особую уличную магию (ничего сложного):
<div class="gist-wrapper"><script src="https://gist.github.com/1768678.js?file=gistfile1.php"></script></div>
Из кода должно быть все понятно, тем более тем, кто следил за серией постов. Параметр <em>supportXhr</em> нужен для того, чтобы не показывать блок, если происходит <em>AJAX</em>-запрос.

И, как обычно, подключаем наш плагин к фронт-контроллеру:
<div class="gist-wrapper"><script src="https://gist.github.com/1768681.js?file=gistfile1.php"></script></div>
Как работает, надеюсь понятно - в конфиге мы просто указываем, какой контроллер и действие из какого модуля загружать. Принцип действия такой же, как и в заметке <a href="/admin-menu-or-blocks-in-zend-framework/">Меню администратора, или блоки в Zend Framework</a>. Кто еще не читал - резко читаем.

Засим откланяюсь, господа.</body>
